(()=>{"use strict";var e=[(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});var o=n(1),a=n(2);const r=new class{constructor(){this.enabled=document.location.href.search("debug")>-1,this.folders={},this.enabled&&(this.stats=new o,document.body.appendChild(this.stats.dom),this.gui=new a.GUI,this.gui.domElement.parentElement.style.zIndex="10000")}begin(){this.enabled&&this.stats.begin()}end(){this.enabled&&this.stats.end()}folder(e,t=!1){if(this.folders[e])return this.folders[e];const n=this.gui.addFolder(e);return t?n.open():n.close(),this.folders[e]=n,this.folders[e]}addButton(e,t,n){const o={click:n};return(void 0!==e?e:this.gui).add(o,"click").name(t)}addOptions(e,t,n,o){const a=void 0!==e?e:this.gui,r={value:n[0]};return a.add(r,"value",n).onChange((e=>{const t=n.indexOf(e);o(e,t)})).name(t)}addInput(e,t,n,o){const a=void 0!==e?e:this.gui;let r=a;return void 0!==o?void 0!==o.min&&(r=void 0!==o.step?a.add(t,n,o.min,o.max,o.step):a.add(t,n,o.min,o.max)):r=a.add(t,n),void 0!==r&&void 0!==o&&(void 0!==o.label&&r.name(o.label),void 0!==o.onChange&&r.onChange((()=>{o.onChange()}))),r}}},e=>{e.exports=stats-js},e=>{e.exports=dat.gui},(e,t,n)=>{n.r(t),n.d(t,{isiPad:()=>o,isiPhone:()=>a,isiOS:()=>r,isChrome:()=>s,isSafari:()=>i,isFirefox:()=>l,isOpera:()=>c,isMobile:()=>d,hasUserMedia:()=>u,supportsWebp:()=>h,delay:()=>m,fileName:()=>p,guid:()=>g});const o=/iPad/i.test(navigator.userAgent),a=/iPhone/i.test(navigator.userAgent),r=o||a,s=/chrome/i.test(navigator.userAgent),i=/^((?!chrome).)*safari/i.test(navigator.userAgent),l=navigator.userAgent.indexOf("Firefox")>-1,c=navigator.userAgent.toLowerCase().indexOf("op")>-1,d=null!==navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/),u=void 0!==(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia),h=(()=>{const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")})();function m(e){return new Promise((t=>{let n=setTimeout((()=>{clearTimeout(n),n=void 0,t()}),1e3*e)}))}function p(e){const t=e.lastIndexOf("/")+1,n=e.lastIndexOf(".");return e.substring(t,n)}function g(){return(Date.now()+Math.round(99999*Math.random())).toString()}},(e,t,n)=>{n.r(t),n.d(t,{default:()=>a});var o=n(3);const a=new class{constructor(){this.supportsBlob=!1;try{this.supportsBlob=!!new Blob}catch(e){this.supportsBlob=!1}}async loadXHR(e,t,n){return new Promise(((o,a)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType=t,r.addEventListener("progress",(e=>{const t=e.loaded/e.total;n(t)}),!1),r.addEventListener("load",(()=>{o(r)}),!1),r.addEventListener("error",(()=>{a()}),!1),r.send()}))}async loadImageBlob(e,t){return new Promise(((n,o)=>{this.loadXHR(e,"blob",t).then((e=>{const t=new Image;window.URL.revokeObjectURL(e.response),t.src=window.URL.createObjectURL(e.response),n(t)})).catch(o)}))}async loadImageElement(e){return new Promise(((t,n)=>{const o=new Image;o.addEventListener("error",(()=>{n()}),!1),o.addEventListener("load",(()=>{t(o)}),!1),o.src=e}))}async loadImages(e,t,n){const o=[];if(this.supportsBlob){const a={},r=()=>{let e=0,t=0;Object.keys(a).forEach((n=>{t++,e+=a[n]}));n(e/t)};t.forEach((t=>{a[t]=0,o.push(this.loadImageBlob(e+t,(e=>{a[t]=e,r()})))}))}else{let a=0;const r=t.length;t.forEach((t=>{o.push(new Promise(((o,s)=>{this.loadImageElement(e+t).then((e=>{++a;n(a/r),o(e)})).catch(s)})))}))}return Promise.all(o)}async loadJSON(e,t){return new Promise(((n,o)=>{this.loadXHR(e,"json",t).then((e=>{let t=e.response;"string"==typeof t&&(t=JSON.parse(t)),n(t)})).catch(o)}))}async loadAudioElement(e){return new Promise(((t,n)=>{const o=document.createElement("audio");o.autoplay=!1,o.src=e,o.addEventListener("error",(()=>{n()}),!1),o.addEventListener("canplaythrough",(()=>{t(o)}),!1),o.load()}))}async loadVideoElement(e){return new Promise(((t,n)=>{const o=document.createElement("video");o.autoplay=!1,o.src=e,o.addEventListener("error",(()=>{n()}),!1),o.addEventListener("canplaythrough",(()=>{t(o)}),!1),o.load()}))}async loadAssets(e,t){return new Promise(((n,a)=>{let r=0;const s=e.length,i={audio:{},custom:{},images:{},json:{},videos:{}};if(s<1)return t(1),void n(i);let l=setInterval((()=>{const e=r/(s-1);t(Number.isNaN(e)?0:e)}),1e3/30);const c=()=>{clearInterval(l),l=void 0},d=()=>{++r,r>=s&&(t(1),c(),n(i))};e.forEach((e=>{const{type:t}=e,{file:n}=e;switch(t){case"audio":this.loadAudioElement(n).then((e=>{const t=(0,o.fileName)(n);i.audio[t]=e,d()})).catch((()=>{c(),a(`Error loading: ${n}`)}));break;case"custom":e.load(n).then((e=>{const t=(0,o.fileName)(n);i.custom[t]=e,d()})).catch((()=>{c(),a(`Error loading: ${n}`)}));break;default:case"image":this.loadImageElement(n).then((e=>{const t=(0,o.fileName)(n);i.images[t]=e,d()})).catch((()=>{c(),a(`Error loading: ${n}`)}));break;case"json":this.loadJSON(n,(()=>{})).then((e=>{const t=(0,o.fileName)(n);i.json[t]=e,d()})).catch((()=>{c(),a(`Error loading: ${n}`)}));break;case"video":this.loadVideoElement(n).then((e=>{const t=(0,o.fileName)(n);i.videos[t]=e,d()})).catch((()=>{c(),a(`Error loading: ${n}`)}))}}))}))}}},(e,t,n)=>{n.r(t),n.d(t,{DEGREES:()=>o,RADIANS:()=>a,TWO_PI:()=>r,HALF_PI:()=>s,between:()=>i,clamp:()=>l,normalize:()=>c,mix:()=>d,map:()=>u,roundTo:()=>h,distance:()=>m,distance2:()=>p,distance3:()=>g,random:()=>f,getAngle:()=>b,toRad:()=>v,toDeg:()=>w,cubicBezier:()=>x,mixArrays:()=>k});const o=180/Math.PI,a=Math.PI/180,r=2*Math.PI,s=Math.PI/2;function i(e,t,n){return n>=e&&n<=t}function l(e,t,n){return Math.min(t,Math.max(e,n))}function c(e,t,n){return(n-e)/(t-e)}function d(e,t,n){return e*(1-n)+t*n}function u(e,t,n,o,a){return d(n,o,c(e,t,a))}function h(e,t=1){return Number(e.toFixed(t))}function m(e,t){const n=e-t;return Math.sqrt(n*n)}function p(e,t,n,o){const a=e-n,r=t-o;return Math.sqrt(a*a+r*r)}function g(e,t,n,o,a,r){const s=e-o,i=t-a,l=n-r;return Math.sqrt(s*s+i*i+l*l)}function f(e,t){return d(e,t,Math.random())}function b(e,t,n,o){return Math.atan2(o-t,n-e)}function v(e){return e*a}function w(e){return e*o}function y(e,t,n,o){return 1/(3*t*e*e+2*n*e+o)}function E(e,t,n,o,a){return t*(e*e*e)+n*(e*e)+o*e+a}function x(e,t,n,o,a){if(e<=0)return 0;if(e>=1)return 1;if(function(e,t,n,o){return e===t&&n===o}(t,n,o,a))return e;const r=1-3*o+3*t-0,s=3*o-6*t+0,i=3*t-0,l=1-3*a+3*n-0,c=3*a-6*n+0,d=3*n-0;let u=e;for(let t=0;t<5;t++){const t=E(u,r,s,i,0);let n=y(u,r,s,i);n===1/0&&(n=e),u-=(t-e)*n,u=Math.min(Math.max(u,0),1)}return function(e,t,n,o,a){const r=e*e;return t*(r*e)+n*r+o*e+a}(u,l,c,d,0)}function k(e,t,n){const o=[],a=e.length;for(let r=0;r<a;++r)o.push(d(e[r],t[r],n));return o}},(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});const o=new class{constructor(){this.playing=!1,this.clock={elapsed:0,delta:0,start:0,last:0,now:()=>performance.now(),seconds:()=>this.clock.elapsed/1e3,restart:()=>{this.clock.delta=0,this.clock.elapsed=0;const e=this.clock.now();this.clock.start=e,this.clock.last=e},update:()=>{const e=this.clock.now();this.clock.delta=e-this.clock.last,this.clock.delta>1e3&&(this.clock.delta=0),this.clock.elapsed+=this.clock.delta,this.clock.last=e}},this.callbacks=[],this.onUpdate=()=>{this.update(),this.onRAF=window.requestAnimationFrame(this.onUpdate)},document.addEventListener("visibilitychange",(()=>{this.playing=!document.hidden}),!1)}add(e){const t=this.callbacks.length;for(let n=0;n<t;++n)if(this.callbacks[n]===e)return;this.callbacks.push(e)}remove(e){const t=this.callbacks.length;for(let n=0;n<t;++n)if(this.callbacks[n]===e)return void this.callbacks.splice(n,1)}play(){this.playing||(this.playing=!0,this.clock.restart(),this.onUpdate())}pause(){this.playing&&(this.playing=!1,window.cancelAnimationFrame(this.onRAF),this.onRAF=void 0)}update(){if(this.playing){const e=this.callbacks.length;for(let t=0;t<e;++t)this.callbacks[t]();this.clock.update()}}}},(e,t,n)=>{n.r(t),n.d(t,{orthoCamera:()=>r,plane:()=>s,dispose:()=>i,parseShader:()=>l,anchorGeometry:()=>c,anchorGeometryTL:()=>d,setBlendNormal:()=>u,setBlendAdd:()=>h,setBlendMultiply:()=>m,setBlendScreen:()=>p,FBO:()=>g,DoubleFBO:()=>f,Pass:()=>b,updateTextureData:()=>v});var o=n(8),a=n(3);const r=new o.OrthographicCamera(-.5,.5,.5,-.5,0,1),s=new o.PlaneBufferGeometry(1,1);function i(e){for(;e.children.length>0;)i(e.children[0]);e.parent&&e.parent.remove(e),e.geometry&&e.geometry.dispose(),e.material&&(e.material.map&&e.material.map.dispose(),e.material.dispose())}function l(e,t,n){let a=e;const r=`// defines\n${t.join("\n")}`,s=`// options\n${n.join("\n")}`;a=a.replace("/** DEFINES */",r),a=a.replace("/** OPTIONS */",s);const i=a.match(/\#include\s?\<\s?(\w+)\s?\>/gm);if(i){const e=i.length;for(let t=0;t<e;++t){const e=i[t],n=e.substr(10,e.length-11),r=`// ${n}\n${o.ShaderChunk[n]}`;a=a.replace(e,r)}}return a}function c(e,t,n,a){e.applyMatrix4((new o.Matrix4).makeTranslation(t,-n,-a))}function d(e){e.computeBoundingBox();const t=e.boundingBox;c(e,(t.max.x-t.min.x)/2,(t.max.y-t.min.y)/2,0)}function u(e){e.blending=o.NormalBlending,e.blendEquation=o.AddEquation,e.blendSrc=o.SrcAlphaFactor,e.blendDst=o.OneMinusSrcAlphaFactor,e.needsUpdate=!0}function h(e){e.blending=o.CustomBlending,e.blendEquation=o.AddEquation,e.blendSrc=o.SrcAlphaFactor,e.blendDst=o.OneFactor,e.needsUpdate=!0}function m(e){e.blending=o.CustomBlending,e.blendEquation=o.AddEquation,e.blendSrc=o.DstColorFactor,e.blendDst=o.OneMinusSrcAlphaFactor,e.needsUpdate=!0}function p(e){e.blending=o.CustomBlending,e.blendEquation=o.AddEquation,e.blendSrc=o.OneMinusDstColorFactor,e.blendDst=o.OneFactor,e.needsUpdate=!0}class g{constructor(e,t,n){const r=void 0!==n?n:{};void 0===r.wrapS&&(r.wrapS=o.ClampToEdgeWrapping),void 0===r.wrapT&&(r.wrapT=o.ClampToEdgeWrapping),void 0===r.minFilter&&(r.minFilter=o.LinearFilter),void 0===r.magFilter&&(r.magFilter=o.LinearFilter),void 0===r.format&&(r.format=o.RGBAFormat),void 0===r.type&&(r.type=a.isiOS?o.HalfFloatType:o.FloatType),void 0===r.depthBuffer&&(r.depthBuffer=!1),void 0===r.stencil&&(r.stencil=!1),this.rt1=new o.WebGLRenderTarget(e,t,r),this.target=this.rt1}resize(e,t){this.rt1.setSize(e,t)}get texture(){return this.target.texture}}class f extends g{constructor(e,t,n){super(e,t,n),this.flip=!0,this.rt2=this.rt1.clone()}resize(e,t){this.rt1.setSize(e,t),this.rt2.setSize(e,t)}swap(){this.flip?this.target=this.rt2:this.target=this.rt1,this.flip=!this.flip}}class b{constructor(e){this.camera=r,this.scene=new o.Scene,this.material=e,this.mesh=new o.Mesh(s,this.material),this.scene.add(this.mesh)}draw(){}}async function v(e,t,n){return new Promise((a=>{const r=e.outerHTML,s=new Blob([[r]],{type:"image/svg+xml"});let i;const l=new Image;let c;l.onload=()=>{i=new o.Texture(l),i.minFilter=o.LinearFilter,i.magFilter=o.LinearFilter,i.needsUpdate=!0,a(i)};const d=new FileReader;d.onload=()=>{c=d.result,l.src=c,l.width=t*devicePixelRatio,l.height=n*devicePixelRatio},c=d.readAsDataURL(s)}))}},e=>{e.exports=three}],t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(0),n(3),n(4),n(5),n(6);n(7)})();
//# sourceMappingURL=utils-three.js.map